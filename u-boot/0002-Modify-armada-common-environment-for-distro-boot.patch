From ed79545e83c50b791182591df0d6a03a348ea7a2 Mon Sep 17 00:00:00 2001
From: Andrew Abbott <mirrexagon@mirrexagon.com>
Date: Sun, 21 Jul 2019 10:53:36 +1000
Subject: [PATCH 2/2] Modify armada-common environment for distro boot

---
 include/configs/mvebu_armada-common.h | 46 +++------------------------
 1 file changed, 5 insertions(+), 41 deletions(-)

diff --git a/include/configs/mvebu_armada-common.h b/include/configs/mvebu_armada-common.h
index 84be257c17..89c902452d 100644
--- a/include/configs/mvebu_armada-common.h
+++ b/include/configs/mvebu_armada-common.h
@@ -25,56 +25,20 @@
 					  115200, 230400, 460800, 921600 }
 
 /* Default Env vars */
-#define CONFIG_IPADDR			0.0.0.0	/* In order to cause an error */
-#define CONFIG_SERVERIP			0.0.0.0	/* In order to cause an error */
-#define CONFIG_NETMASK			255.255.255.0
-#define CONFIG_GATEWAYIP		10.4.50.254
 #define CONFIG_HAS_ETH1
 #define CONFIG_HAS_ETH2
 #define CONFIG_ETHPRIME			"eth0"
-#define CONFIG_ROOTPATH                 "/srv/nfs/" /* Default Dir for NFS */
 #define CONFIG_ENV_OVERWRITE		/* ethaddr can be reprogrammed */
-#define CONFIG_EXTRA_ENV_SETTINGS	"bootcmd=run get_images; " \
-						"run set_bootargs; " \
-						"booti $kernel_addr_r " \
-						"$ramdisk_addr_r " \
-						"$fdt_addr_r\0" \
-					"extra_params=pci=pcie_bus_safe\0" \
-					"kernel_addr_r=0x7000000\0"	\
-					"initrd_addr=0xa00000\0"	\
-					"initrd_size=0x2000000\0"	\
+#define CONFIG_EXTRA_ENV_SETTINGS \
 					"fdt_addr_r=0x6f00000\0"	\
-					"loadaddr=0x6000000\0"		\
-					"fdt_high=0xffffffffffffffff\0"	\
-					"hostname=marvell\0"		\
 					"ramdisk_addr_r=0x8000000\0"	\
-					"ramfs_name=-\0"		\
-					"fdt_name=fdt.dtb\0"		\
-					"netdev=eth0\0"			\
+                    "kernel_addr_r=0x7000000\0"	\
+					"pxefile_addr_r=0x6e00000\0"	\
+					"scriptaddr=0x6d00000\0"	\
 					"ethaddr=00:51:82:11:22:00\0"	\
 					"eth1addr=00:51:82:11:22:01\0"	\
 					"eth2addr=00:51:82:11:22:02\0"	\
-					"eth3addr=00:51:82:11:22:03\0"	\
-					"image_name=Image\0"		\
-					"get_ramfs=if test \"${ramfs_name}\"" \
-						" != \"-\"; then setenv " \
-						"ramdisk_addr_r 0x8000000; " \
-						"tftpboot $ramdisk_addr_r " \
-						"$ramfs_name; else setenv " \
-						"ramdisk_addr_r -;fi\0"	\
-					"get_images=tftpboot $kernel_addr_r " \
-						"$image_name; tftpboot " \
-						"$fdt_addr_r $fdt_name; " \
-						"run get_ramfs\0"	\
-					"console=" CONFIG_DEFAULT_CONSOLE "\0"\
-					"root=root=/dev/nfs rw\0"	\
-					"set_bootargs=setenv bootargs $console"\
-						" $root ip=$ipaddr:$serverip:" \
-						"$gatewayip:$netmask:$hostname"\
-						":$netdev:none nfsroot="\
-						"$serverip:$rootpath,tcp,v3 " \
-						"$extra_params " \
-						"$cpuidle"
+					"eth3addr=00:51:82:11:22:03\0"
 /*
  * For booting Linux, the board info and command line data
  * have to be in the first 8 MB of memory, since this is
-- 
2.22.0

